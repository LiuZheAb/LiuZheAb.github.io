(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[87],{563:function(e,t,a){},744:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return C}));a(479);var n=a(470),l=(a(379),a(476)),r=(a(380),a(396)),i=(a(554),a(672)),m=(a(212),a(219)),c=(a(257),a(269)),o=(a(258),a(270)),s=(a(556),a(739)),u=(a(558),a(735)),f=(a(560),a(738)),d=a(11),h=a(12),p=a(16),v=a(13),g=a(14),y=(a(330),a(351)),E=(a(297),a(272)),b=a(0),N=a.n(b),V=a(754),k=a(755),I=(a(563),E.a.Option),L=y.a.TextArea,C=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={formName:"",itemList:[],itemNum:0,inputType:["text","radio","checkbox","select","textarea","upload"],initCreateValues:{}},e.changeFormName=function(t){e.setState({formName:t.target.value})},e.changeItemNum=function(t){var a=e.state,n=a.itemList,l=a.itemNum,r=(t=t?parseInt(t):0)-l;if(t<0||isNaN(t))n=[],t=0;else if(r>0)for(var i=0;i<r;i++)n.push({itemName:"",type:"",defaultValue:[],currentValue:""});else{r=Math.abs(r);for(var m=0;m<r;m++)n.pop()}e.setState({itemNum:t,itemList:n},(function(){r<0&&e.refs.Form.resetFields()}))},e.formNameValidator=function(e,t){return t?Promise.resolve():Promise.reject("\u8868\u5355\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")},e.itemNumValidator=function(e,t){return"number"!==typeof t?Promise.reject("\u63a7\u4ef6\u6570\u91cf\u5fc5\u987b\u4e3a\u6570\u5b57"):0===t?Promise.reject("\u63a7\u4ef6\u4e2a\u6570\u4e0d\u80fd\u4e3a0"):parseInt(t)!==t?Promise.reject("\u63a7\u4ef6\u6570\u91cf\u5fc5\u987b\u4e3a\u6574\u6570"):t?Promise.resolve():Promise.reject("\u8bf7\u8f93\u5165\u63a7\u4ef6\u4e2a\u6570")},e.itemNameValidator=function(t,a,n){if(n){return function(e,t,a){for(var n=[],l=0;l<e.length;l++)a!==l&&n.push(e[l].itemName);return-1!==n.indexOf(t)}(e.state.itemList,n,t)?Promise.reject("\u63a7\u4ef6\u540d\u91cd\u590d,\u8bf7\u4fee\u6539"):Promise.resolve()}return Promise.reject("\u8bf7\u8f93\u5165\u63a7\u4ef6 ".concat(t+1,"\u7684\u540d\u79f0"))},e.itemTypeValidator=function(e,t,a){return a?Promise.resolve():Promise.reject("\u8bf7\u9009\u62e9\u63a7\u4ef6 ".concat(e+1,"\u7684\u7c7b\u578b"))},e.itemValueValidator=function(t,a,n){if(n&&0!==n.length){for(var l={},r=e.state.itemList[t].defaultValue,i=0;i<r.length;i++){if(l[r[i]])return Promise.reject("\u4e0d\u80fd\u6709\u91cd\u590d\u7684\u9009\u9879\uff0c\u8bf7\u4fee\u6539");l[r[i]]=!0}return Promise.resolve()}return Promise.reject("\u9ed8\u8ba4\u503c\u4e0d\u80fd\u4e3a\u7a7a")},e.saveItems=function(){var t=e.state,a=t.formName,n=t.itemList;e.refs.Form.validateFields().then((function(){return function(e,t){var a='{ "formName" :'.concat(JSON.stringify(e),'\n            ,"itemList" :').concat(JSON.stringify(t),"}"),n=document.createElement("a");n.download=+new Date+".json",n.style.display="none";var l=new Blob([a]);n.href=URL.createObjectURL(l),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(a,n)})).catch((function(){console.error("\u8868\u5355\u9a8c\u8bc1\u672a\u901a\u8fc7")}))},e.importItems=function(e){if(e.target.value){var t=new FileReader,a=document.getElementById("file").files[0],n=Object(p.a)(n);t.onload=function(){var e=JSON.parse(this.result),t=e.formName,a=e.itemList;n.setState({formName:t,itemList:a,itemNum:a.length},(function(){n.refs.Form.resetFields()}))},t.readAsText(a)}},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){document.title="\u81ea\u5b9a\u4e49\u8868\u5355"}},{key:"changeItemName",value:function(e,t){var a=this.state.itemList;a[e].itemName=t.target.value,this.setState({itemList:a})}},{key:"changeItemType",value:function(e,t){var a=this.state.itemList;a[e].type=t,a[e].defaultValue=[],a[e].currentValue="",this.setState({itemList:a})}},{key:"changeItemValue",value:function(e,t){var a=[],n=t.target.value,l=this.state.itemList;if(null!==n){-1===n.indexOf(",")?a.push(n):n.indexOf(",")>-1&&(a=n.split(","));for(var r=0;r<a.length;r++)""!==a[r]&&null!==a[r]&&void 0!==typeof a[r]&&","!==a[r]&&"\uff0c"!==a[r]||(a.splice(r,1),r-=1)}l[e].defaultValue=a,this.setState({itemList:l})}},{key:"handleDelete",value:function(e){var t=this,a=this.state.itemList;a.splice(e,1),this.setState({itemList:a,itemNum:a.length},(function(){t.refs.Form.resetFields()}))}},{key:"handleChange",value:function(e,t,a){var n=this.state.itemList;n[e].currentValue="checkbox"===t||"select"===t?a:a.target.value,this.setState({itemList:n})}},{key:"changeUpload",value:function(e,t){if("done"===t.file.status){var a=this.state.itemList;a[e].currentValue=t.fileList,this.setState({itemList:a}),f.a.success("".concat(t.file.name," \u4e0a\u4f20\u6210\u529f"))}else"error"===t.file.status&&f.a.error("".concat(t.file.name," \u4e0a\u4f20\u5931\u8d25"))}},{key:"render",value:function(){var e=this,t=this.state,a=t.formName,f=t.itemNum,d=t.itemList,h=t.inputType,p={name:"file",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",headers:{authorization:"authorization-text"}},v={formName:a,itemNum:f};return N.a.createElement("div",{className:"customform-container"},N.a.createElement("div",{className:"create block"},N.a.createElement("div",{style:{fontSize:20,fontWeight:"600"}},"\u5728\u6b64\u5904\u586b\u5199\u8981\u751f\u6210\u7684\u8868\u5355\u5185\u5bb9"),N.a.createElement("br",null),N.a.createElement(u.a,{className:"create-form",ref:"Form",initialValues:v},N.a.createElement(u.a.Item,{name:"formName",label:"\u8868\u5355\u540d\u79f0",rules:[{validator:this.formNameValidator}],style:{maxWidth:"300px"}},N.a.createElement(y.a,{placeholder:"\u8868\u5355\u540d\u79f0",onChange:this.changeFormName})),N.a.createElement(u.a.Item,{name:"itemNum",label:"\u8868\u5355\u63a7\u4ef6\u6570\u91cf",rules:[{validator:this.itemNumValidator}]},N.a.createElement(s.a,{onChange:this.changeItemNum,min:0})),d.map((function(t,a){var n=t.itemName,l=t.type,r=t.defaultValue,i="radio"===l||"checkbox"===l||"select"===l,m=l?{initialValue:l}:{};return N.a.createElement(c.a,{gutter:10,key:a,className:"item-line"},N.a.createElement(o.a,{span:24,lg:i?10:12},N.a.createElement(u.a.Item,{name:"itemName".concat(a),label:"\u63a7\u4ef6  ".concat(a+1,"\uff1a"),key:"".concat(a,"Name"),rules:[{validator:e.itemNameValidator.bind(e,a)}],initialValue:n},N.a.createElement(y.a,{placeholder:"\u63a7\u4ef6 ".concat(a+1,"\u7684\u540d\u79f0"),onChange:e.changeItemName.bind(e,a)}))),N.a.createElement(o.a,{span:24,lg:i?7:12},N.a.createElement(u.a.Item,Object.assign({className:"col-nolabel",name:"itemType".concat(a),key:"".concat(a,"Type"),rules:[{validator:e.itemTypeValidator.bind(e,a)}]},m),N.a.createElement(E.a,{onChange:e.changeItemType.bind(e,a),placeholder:"--\u63a7\u4ef6\u7c7b\u578b--"},h.map((function(e,t){return N.a.createElement(I,{value:e,key:t},"text"===e?"\u8f93\u5165\u6846":"radio"===e?"\u5355\u9009\u6846":"checkbox"===e?"\u590d\u9009\u6846":"select"===e?"\u9009\u62e9\u5668":"textarea"===e?"\u6587\u672c\u57df":"upload"===e?"\u4e0a\u4f20\u6587\u4ef6":null)}))))),i?N.a.createElement(o.a,{span:24,lg:7},N.a.createElement(u.a.Item,{className:"col-nolabel",name:"itemValue".concat(a),key:"".concat(a,"Value"),rules:[{validator:e.itemValueValidator.bind(e,a)}],getValueFromEvent:function(e){return e.target.value.replace(/\uff0c/g,",")},initialValue:r},N.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u7684\u9ed8\u8ba4\u503c,\u4ee5\u201c,\u201d\u9694\u5f00",onChange:e.changeItemValue.bind(e,a)}))):null,N.a.createElement(o.a,{style:{lineHeight:"30px"},className:"delete-btn"},N.a.createElement(V.a,{onClick:e.handleDelete.bind(e,a),title:"\u5220\u9664\u63a7\u4ef6"})))})),N.a.createElement(u.a.Item,{style:{textAlign:"center",marginTop:"24px"}},N.a.createElement(i.a,null,N.a.createElement(m.a,{type:"primary",onClick:this.saveItems},"\u4fdd\u5b58\u8868\u5355\u6570\u636e"),N.a.createElement(m.a,{type:"primary",onClick:function(){document.getElementById("file").click()}},"\u8bfb\u53d6\u8868\u5355\u6570\u636e"),N.a.createElement("input",{type:"file",name:"import",id:"file",accept:".json",onChange:this.importItems,style:{display:"none"}}))))),N.a.createElement("div",{className:"show block"},N.a.createElement("div",{style:{fontSize:20,fontWeight:"600"}},"\u9884\u89c8\u8868\u5355"),N.a.createElement("div",{style:{textAlign:"center",fontSize:20}},a),N.a.createElement("br",null),N.a.createElement(u.a,{ref:"showForm"},d.map((function(t,a){var i=t.itemName,c=t.type,o=t.defaultValue,s=t.currentValue;switch(c){case"text":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(y.a,{placeholder:i,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"radio":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(r.default.Group,{onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s},o.map((function(e,t){return N.a.createElement(r.default,{key:t,value:e},e)}))));case"checkbox":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(l.a.Group,{options:o,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"select":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(E.a,{onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s},o.map((function(e,t){return N.a.createElement(I,{key:t,value:e},e)}))));case"textarea":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(L,{autoSize:{minRows:4,maxRows:20},cols:10,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"upload":return N.a.createElement(u.a.Item,{label:i,key:a},N.a.createElement(n.a,Object.assign({},p,{onChange:e.changeUpload.bind(e,a),defaultFileList:s}),N.a.createElement(m.a,{type:"default"},N.a.createElement(k.a,null),"\u4e0a\u4f20\u6587\u4ef6")));default:return null}})))))}}]),a}(b.Component)}}]);
//# sourceMappingURL=87.48e1f52f.chunk.js.map