(this.webpackJsonpblog=this.webpackJsonpblog||[]).push([[84],{527:function(e,t,a){},693:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));a(688);var n=a(682),r=(a(513),a(687)),i=(a(515),a(637)),l=(a(517),a(636)),m=(a(253),a(281)),c=(a(258),a(273)),o=(a(259),a(274)),s=(a(519),a(689)),u=(a(521),a(681)),f=(a(523),a(686)),d=a(11),h=a(12),p=a(16),v=a(13),g=a(14),y=(a(525),a(684)),E=(a(303),a(280)),b=a(0),N=a.n(b),V=a(699),k=a(700),x=(a(527),E.a.Option),I=y.a.TextArea,L=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={formName:"",itemList:[],itemNum:0,inputType:["text","radio","checkbox","select","textarea","upload"],initCreateValues:{}},e.changeFormName=function(t){e.setState({formName:t.target.value})},e.changeItemNum=function(t){var a=e.state,n=a.itemList,r=a.itemNum,i=(t=t?parseInt(t):0)-r;if(console.log(t,r),t<0||isNaN(t))n=[],t=0;else if(i>0)for(var l=0;l<i;l++)n.push({itemName:"",type:"",defaultValue:[],currentValue:""});else{i=Math.abs(i);for(var m=0;m<i;m++)n.pop()}e.setState({itemNum:t,itemList:n},(function(){i<0&&e.refs.Form.resetFields()}))},e.formNameValidator=function(e,t){return t?Promise.resolve():Promise.reject("\u8868\u5355\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")},e.itemNumValidator=function(e,t){return"number"!==typeof t?Promise.reject("\u63a7\u4ef6\u6570\u91cf\u5fc5\u987b\u4e3a\u6570\u5b57"):0===t?Promise.reject("\u63a7\u4ef6\u4e2a\u6570\u4e0d\u80fd\u4e3a0"):parseInt(t)!==t?Promise.reject("\u63a7\u4ef6\u6570\u91cf\u5fc5\u987b\u4e3a\u6574\u6570"):t?Promise.resolve():Promise.reject("\u8bf7\u8f93\u5165\u63a7\u4ef6\u4e2a\u6570")},e.itemNameValidator=function(t,a,n){if(n){return function(e,t,a){for(var n=[],r=0;r<e.length;r++)a!==r&&n.push(e[r].itemName);return-1!==n.indexOf(t)}(e.state.itemList,n,t)?Promise.reject("\u63a7\u4ef6\u540d\u91cd\u590d,\u8bf7\u4fee\u6539"):Promise.resolve()}return Promise.reject("\u8bf7\u8f93\u5165\u63a7\u4ef6 ".concat(t+1,"\u7684\u540d\u79f0"))},e.itemTypeValidator=function(e,t,a){return a?Promise.resolve():Promise.reject("\u8bf7\u9009\u62e9\u63a7\u4ef6 ".concat(e+1,"\u7684\u7c7b\u578b"))},e.itemValueValidator=function(t,a,n){if(n&&0!==n.length){for(var r={},i=e.state.itemList[t].defaultValue,l=0;l<i.length;l++){if(r[i[l]])return Promise.reject("\u4e0d\u80fd\u6709\u91cd\u590d\u7684\u9009\u9879\uff0c\u8bf7\u4fee\u6539");r[i[l]]=!0}return Promise.resolve()}return Promise.reject("\u9ed8\u8ba4\u503c\u4e0d\u80fd\u4e3a\u7a7a")},e.saveItems=function(){var t=e.state,a=t.formName,n=t.itemList;e.refs.Form.validateFields().then((function(){return function(e,t){var a='{ "formName" :'.concat(JSON.stringify(e),'\n            ,"itemList" :').concat(JSON.stringify(t),"}"),n=document.createElement("a");n.download=+new Date+".json",n.style.display="none";var r=new Blob([a]);n.href=URL.createObjectURL(r),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(a,n)})).catch((function(){console.error("\u8868\u5355\u9a8c\u8bc1\u672a\u901a\u8fc7")}))},e.importItems=function(e){if(e.target.value){var t=new FileReader,a=document.getElementById("file").files[0],n=Object(p.a)(n);t.onload=function(){var e=JSON.parse(this.result),t=e.formName,a=e.itemList;n.setState({formName:t,itemList:a,itemNum:a.length},(function(){n.refs.Form.resetFields()}))},t.readAsText(a)}},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){document.title="\u81ea\u5b9a\u4e49\u8868\u5355"}},{key:"changeItemName",value:function(e,t){var a=this.state.itemList;a[e].itemName=t.target.value,this.setState({itemList:a})}},{key:"changeItemType",value:function(e,t){var a=this.state.itemList;a[e].type=t,a[e].defaultValue=[],a[e].currentValue="",this.setState({itemList:a})}},{key:"changeItemValue",value:function(e,t){var a=[],n=t.target.value,r=this.state.itemList;if(null!==n){-1===n.indexOf(",")?a.push(n):n.indexOf(",")>-1&&(a=n.split(","));for(var i=0;i<a.length;i++)""!==a[i]&&null!==a[i]&&void 0!==typeof a[i]&&","!==a[i]&&"\uff0c"!==a[i]||(a.splice(i,1),i-=1)}r[e].defaultValue=a,this.setState({itemList:r})}},{key:"handleDelete",value:function(e){var t=this,a=this.state.itemList;a.splice(e,1),this.setState({itemList:a,itemNum:a.length},(function(){t.refs.Form.resetFields()}))}},{key:"handleChange",value:function(e,t,a){var n=this.state.itemList;n[e].currentValue="checkbox"===t||"select"===t?a:a.target.value,this.setState({itemList:n})}},{key:"changeUpload",value:function(e,t){if("done"===t.file.status){var a=this.state.itemList;a[e].currentValue=t.fileList,this.setState({itemList:a}),f.a.success("".concat(t.file.name," \u4e0a\u4f20\u6210\u529f"))}else"error"===t.file.status&&f.a.error("".concat(t.file.name," \u4e0a\u4f20\u5931\u8d25"))}},{key:"render",value:function(){var e=this,t=this.state,a=t.formName,f=t.itemNum,d=t.itemList,h=t.inputType,p={name:"file",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",headers:{authorization:"authorization-text"}},v={formName:a,itemNum:f};return N.a.createElement("div",{className:"customform-container"},N.a.createElement("div",{className:"create block"},N.a.createElement("div",{style:{fontSize:20,fontWeight:"600"}},"\u5728\u6b64\u5904\u586b\u5199\u8981\u751f\u6210\u7684\u8868\u5355\u5185\u5bb9"),N.a.createElement("br",null),N.a.createElement(u.a,{className:"create-form",ref:"Form",initialValues:v},N.a.createElement(u.a.Item,{name:"formName",label:"\u8868\u5355\u540d\u79f0",rules:[{validator:this.formNameValidator}],style:{maxWidth:"300px"}},N.a.createElement(y.a,{placeholder:"\u8868\u5355\u540d\u79f0",onChange:this.changeFormName})),N.a.createElement(u.a.Item,{name:"itemNum",label:"\u8868\u5355\u63a7\u4ef6\u6570\u91cf",rules:[{validator:this.itemNumValidator}]},N.a.createElement(s.a,{onChange:this.changeItemNum,min:0})),d.map((function(t,a){var n=t.itemName,r=t.type,i=t.defaultValue,l="radio"===r||"checkbox"===r||"select"===r,m=r?{initialValue:r}:{};return N.a.createElement(c.a,{gutter:10,key:a},N.a.createElement(o.a,{xs:l?8:12},N.a.createElement(u.a.Item,{name:"itemName".concat(a),label:"\u63a7\u4ef6  ".concat(a+1,"\uff1a"),key:"".concat(a,"Name"),rules:[{validator:e.itemNameValidator.bind(e,a)}],initialValue:n},N.a.createElement(y.a,{placeholder:"\u63a7\u4ef6 ".concat(a+1,"\u7684\u540d\u79f0"),onChange:e.changeItemName.bind(e,a)}))),N.a.createElement(o.a,{xs:l?7:11},N.a.createElement(u.a.Item,Object.assign({name:"itemType".concat(a),key:"".concat(a,"Type"),rules:[{validator:e.itemTypeValidator.bind(e,a)}]},m),N.a.createElement(E.a,{onChange:e.changeItemType.bind(e,a),placeholder:"--\u63a7\u4ef6\u7c7b\u578b--"},h.map((function(e,t){return N.a.createElement(x,{value:e,key:t},"text"===e?"\u8f93\u5165\u6846":"radio"===e?"\u5355\u9009\u6846":"checkbox"===e?"\u590d\u9009\u6846":"select"===e?"\u9009\u62e9\u5668":"textarea"===e?"\u6587\u672c\u57df":"upload"===e?"\u4e0a\u4f20\u6587\u4ef6":null)}))))),l?N.a.createElement(o.a,{xs:8},N.a.createElement(u.a.Item,{name:"itemValue".concat(a),key:"".concat(a,"Value"),rules:[{validator:e.itemValueValidator.bind(e,a)}],getValueFromEvent:function(e){return e.target.value.replace(/\uff0c/g,",")},initialValue:i},N.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u63a7\u4ef6\u7684\u9ed8\u8ba4\u503c,\u4ee5\u201c,\u201d\u9694\u5f00",onChange:e.changeItemValue.bind(e,a)}))):null,N.a.createElement(o.a,{xs:1,style:{lineHeight:"30px"}},N.a.createElement(V.a,{onClick:e.handleDelete.bind(e,a),title:"\u5220\u9664\u63a7\u4ef6"})))})),N.a.createElement(u.a.Item,{style:{textAlign:"center",marginTop:"24px"}},N.a.createElement(l.a,null,N.a.createElement(m.a,{type:"primary",onClick:this.saveItems},"\u4fdd\u5b58\u8868\u5355\u6570\u636e"),N.a.createElement(m.a,{type:"primary",onClick:function(){document.getElementById("file").click()}},"\u8bfb\u53d6\u8868\u5355\u6570\u636e"),N.a.createElement("input",{type:"file",name:"import",id:"file",accept:".json",onChange:this.importItems,style:{display:"none"}}))))),N.a.createElement("div",{className:"show block"},N.a.createElement("div",{style:{fontSize:20,fontWeight:"600"}},"\u9884\u89c8\u8868\u5355"),N.a.createElement("div",{style:{textAlign:"center",fontSize:20}},a),N.a.createElement("br",null),N.a.createElement(u.a,{ref:"showForm"},d.map((function(t,a){var l=t.itemName,c=t.type,o=t.defaultValue,s=t.currentValue;switch(c){case"text":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(y.a,{placeholder:l,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"radio":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(i.default.Group,{onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s},o.map((function(e,t){return N.a.createElement(i.default,{key:t,value:e},e)}))));case"checkbox":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(r.a.Group,{options:o,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"select":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(E.a,{onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s},o.map((function(e,t){return N.a.createElement(x,{key:t,value:e},e)}))));case"textarea":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(I,{autoSize:{minRows:4,maxRows:20},cols:10,onChange:e.handleChange.bind(e,a,c),value:s,defaultValue:s}));case"upload":return N.a.createElement(u.a.Item,{label:l,key:a},N.a.createElement(n.a,Object.assign({},p,{onChange:e.changeUpload.bind(e,a),defaultFileList:s}),N.a.createElement(m.a,{type:"default"},N.a.createElement(k.a,null),"\u4e0a\u4f20\u6587\u4ef6")));default:return null}})))))}}]),a}(b.Component)}}]);
//# sourceMappingURL=84.a85acd2e.chunk.js.map