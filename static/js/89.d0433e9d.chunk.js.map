{"version":3,"sources":["pages/CustomForm/index.js"],"names":["Option","TextArea","index","state","formName","itemList","itemNum","inputType","initCreateValues","changeFormName","e","setState","target","value","changeItemNum","disValue","parseInt","isNaN","i","push","itemName","type","defaultValue","currentValue","Math","abs","pop","refs","Form","resetFields","formNameValidator","rule","Promise","resolve","reject","itemNumValidator","itemNameValidator","arr","array","length","indexOf","checkRepeatName","itemTypeValidator","itemValueValidator","hash","saveItems","validateFields","then","name","makeJson","JSON","stringify","elementA","document","createElement","download","Date","style","display","blob","Blob","href","URL","createObjectURL","body","appendChild","click","removeChild","saveFile","catch","console","error","importItems","reader","FileReader","file","getElementById","files","_this","onload","importJson","parse","this","result","readAsText","title","split","undefined","splice","info","status","fileList","success","uploadProps","action","headers","authorization","className","fontSize","fontWeight","ref","initialValues","Item","label","rules","validator","maxWidth","placeholder","onChange","min","map","ifThreeColumns","props","initialValue","gutter","key","span","lg","bind","changeItemName","changeItemType","getValueFromEvent","replace","changeItemValue","lineHeight","onClick","handleDelete","textAlign","marginTop","id","accept","handleChange","Group","index2","options","autoSize","minRows","maxRows","cols","changeUpload","defaultFileList","Component"],"mappings":"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","file":"static/js/89.d0433e9d.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport { Form, Button, InputNumber, Select, Input, Row, Col, message, Upload, Radio, Checkbox, Space } from \"antd\";\r\nimport { UploadOutlined, CloseCircleFilled } from '@ant-design/icons';\r\nimport \"./index.less\";\r\n\r\nconst { Option } = Select;\r\nconst { TextArea } = Input;\r\nexport default class index extends Component {\r\n    state = {\r\n        formName: '',\r\n        itemList: [],\r\n        itemNum: 0,\r\n        inputType: [\"text\", \"radio\", \"checkbox\", \"select\", \"textarea\", \"upload\"],\r\n        initCreateValues: {}\r\n    };\r\n    componentDidMount() {\r\n        document.title = \"自定义表单\";\r\n    }\r\n    //表单名称\r\n    changeFormName = e => {\r\n        this.setState({ formName: e.target.value });\r\n    };\r\n    //控件数量\r\n    changeItemNum = value => {\r\n        let { itemList, itemNum } = this.state;\r\n        value = value ? parseInt(value) : 0;\r\n        //获取当前itemNum与前一个itemNum的差值\r\n        let disValue = value - itemNum;\r\n        if (value < 0 || isNaN(value)) {\r\n            itemList = [];\r\n            value = 0;\r\n        } else {\r\n            if (disValue > 0) {\r\n                for (let i = 0; i < disValue; i++) {\r\n                    itemList.push({ itemName: \"\", type: \"\", defaultValue: [], currentValue: \"\" });\r\n                };\r\n            } else {\r\n                disValue = Math.abs(disValue);\r\n                for (let i = 0; i < disValue; i++) {\r\n                    itemList.pop();\r\n                };\r\n            };\r\n        }\r\n        this.setState({\r\n            itemNum: value,\r\n            itemList\r\n        }, () => {\r\n            if (disValue < 0) { this.refs.Form.resetFields() };\r\n        });\r\n    };\r\n    //控件名称\r\n    changeItemName(index, e) {\r\n        let { itemList } = this.state;\r\n        itemList[index].itemName = e.target.value;\r\n        this.setState({ itemList });\r\n    };\r\n    //控件类型\r\n    changeItemType(index, value) {\r\n        let { itemList } = this.state;\r\n        itemList[index].type = value;\r\n        itemList[index].defaultValue = [];\r\n        itemList[index].currentValue = \"\";\r\n        this.setState({ itemList });\r\n    };\r\n    //控件默认值\r\n    changeItemValue(index, e) {\r\n        let defaultValue = [], value = e.target.value, { itemList } = this.state;\r\n        if (value !== null) {\r\n            //如果没有“,”，则输入的内容就是defaultValue\r\n            if (value.indexOf(\",\") === -1) {\r\n                defaultValue.push(value);\r\n            } //如果有“,”，则将输入的内容按“,”分隔开\r\n            else if (value.indexOf(\",\") > -1) {\r\n                defaultValue = value.split(\",\");\r\n            };\r\n            //删除空值或逗号\r\n            for (let i = 0; i < defaultValue.length; i++) {\r\n                if (defaultValue[i] === \"\" || defaultValue[i] === null || typeof defaultValue[i] === undefined || defaultValue[i] === \",\" || defaultValue[i] === \"，\") {\r\n                    defaultValue.splice(i, 1);\r\n                    i = i - 1;\r\n                }\r\n            };\r\n        }\r\n        itemList[index].defaultValue = defaultValue;\r\n        this.setState({ itemList: itemList });\r\n    };\r\n    handleDelete(index) {\r\n        let { itemList } = this.state;\r\n        itemList.splice(index, 1)\r\n        this.setState({ itemList, itemNum: itemList.length }, () => {\r\n            this.refs.Form.resetFields();\r\n        });\r\n    }\r\n    //表单验证\r\n    formNameValidator = (rule, value) => {\r\n        if (!value) {\r\n            return Promise.reject('表单名称不能为空');\r\n        } else {\r\n            return Promise.resolve();\r\n        };\r\n    };\r\n    itemNumValidator = (rule, value) => {\r\n        if (typeof (value) !== \"number\") {\r\n            return Promise.reject('控件数量必须为数字');\r\n        } else if (value === 0) {\r\n            return Promise.reject('控件个数不能为0');\r\n        } else if (parseInt(value) !== value) {\r\n            return Promise.reject('控件数量必须为整数');\r\n        } else if (!value) {\r\n            return Promise.reject('请输入控件个数');\r\n        } else {\r\n            return Promise.resolve();\r\n        };\r\n    }\r\n    itemNameValidator = (index, rule, value) => {\r\n        if (!value) {\r\n            return Promise.reject(`请输入控件 ${index + 1}的名称`);\r\n        } else {\r\n            let { itemList } = this.state;\r\n            let checkRepeatName = (arr, value, index) => {\r\n                let array = [];\r\n                for (let i = 0; i < arr.length; i++) {\r\n                    if (index !== i) {\r\n                        array.push(arr[i].itemName);\r\n                    }\r\n                };\r\n                if (array.indexOf(value) === -1) {\r\n                    return false;\r\n                } else {\r\n                    return true\r\n                }\r\n            };\r\n            if (!checkRepeatName(itemList, value, index)) {\r\n                return Promise.resolve();\r\n            } else {\r\n                return Promise.reject(\"控件名重复,请修改\");\r\n            }\r\n        };\r\n    };\r\n    itemTypeValidator = (index, rule, value) => {\r\n        if (!value) {\r\n            return Promise.reject(`请选择控件 ${index + 1}的类型`);\r\n        } else {\r\n            return Promise.resolve();\r\n        };\r\n    };\r\n    itemValueValidator = (index, rule, value) => {\r\n        if (!value || value.length === 0) {\r\n            return Promise.reject('默认值不能为空');\r\n        } else {\r\n            let hash = {}, defaultValue = this.state.itemList[index].defaultValue;\r\n            for (let i = 0; i < defaultValue.length; i++) {\r\n                if (hash[defaultValue[i]]) {\r\n                    return Promise.reject(\"不能有重复的选项，请修改\");\r\n                }\r\n                hash[defaultValue[i]] = true;\r\n            }\r\n            return Promise.resolve();\r\n        };\r\n    };\r\n    /**\r\n         * 表单value改变时调用\r\n         * @param {*} index 表单控件序号\r\n         * @param {*} type 表单控件类型\r\n         */\r\n    handleChange(index, type, e) {\r\n        let { itemList } = this.state;\r\n        itemList[index].currentValue = type === \"checkbox\" || type === \"select\" ? e : e.target.value;\r\n        this.setState({\r\n            itemList\r\n        });\r\n    }\r\n    changeUpload(index, info) {\r\n        if (info.file.status === \"done\") {\r\n            let { itemList } = this.state;\r\n            itemList[index].currentValue = info.fileList;\r\n            this.setState({ itemList });\r\n            message.success(`${info.file.name} 上传成功`);\r\n        } else if (info.file.status === \"error\") {\r\n            message.error(`${info.file.name} 上传失败`);\r\n        };\r\n    };\r\n\r\n\r\n    saveItems = () => {\r\n        let { formName, itemList } = this.state;\r\n        const saveFile = (name, itemList) => {\r\n            let makeJson = `{ \"formName\" :${JSON.stringify(name)}\r\n            ,\"itemList\" :${JSON.stringify(itemList)}}`;\r\n            //保存到本地\r\n            //虚拟dom实现下载   \r\n            var elementA = document.createElement('a');\r\n            elementA.download = +new Date() + \".json\";//文件名\r\n            //隐藏dom点不显示\r\n            elementA.style.display = 'none';\r\n            var blob = new Blob([makeJson]);//二进制\r\n            elementA.href = URL.createObjectURL(blob);\r\n            document.body.appendChild(elementA);\r\n            elementA.click();\r\n            document.body.removeChild(elementA);\r\n        }\r\n        this.refs.Form.validateFields()\r\n            .then(() => saveFile(formName, itemList))\r\n            .catch(() => { console.error(\"表单验证未通过\") })\r\n    }\r\n    importItems = (e) => {\r\n        if (e.target.value) {\r\n            let reader = new FileReader();\r\n            //读取json\r\n            let file = document.getElementById('file').files[0];\r\n            //外层作用域的重新定义\r\n            let _this = this;\r\n            reader.onload = function () {\r\n                var importJson = JSON.parse(this.result);\r\n                let { formName, itemList } = importJson;\r\n                _this.setState({\r\n                    formName,\r\n                    itemList,\r\n                    itemNum: itemList.length,\r\n                }, () => {\r\n                    //表单的initialValues属性只在初始化或重置时生效\r\n                    _this.refs.Form.resetFields();\r\n                });\r\n            };\r\n            reader.readAsText(file);\r\n        };\r\n    }\r\n    render() {\r\n        const { formName, itemNum, itemList, inputType } = this.state;\r\n        const uploadProps = {\r\n            name: 'file',\r\n            action: 'https://www.mocky.io/v2/5cc8019d300000980a055e76',\r\n            headers: {\r\n                authorization: 'authorization-text',\r\n            },\r\n        };\r\n        let initCreateValues = {\r\n            formName: formName,\r\n            itemNum: itemNum,\r\n        };\r\n        return (\r\n            <div className=\"customform-container\">\r\n                <div className=\"create block\">\r\n                    <div style={{ fontSize: 20, fontWeight: \"600\" }}>在此处填写要生成的表单内容</div>\r\n                    <br />\r\n                    <Form className=\"create-form\" ref=\"Form\" initialValues={initCreateValues}>\r\n                        <Form.Item name=\"formName\" label=\"表单名称\" rules={[{ validator: this.formNameValidator }]} style={{ maxWidth: \"300px\" }}>\r\n                            <Input placeholder=\"表单名称\" onChange={this.changeFormName} />\r\n                        </Form.Item>\r\n                        <Form.Item name=\"itemNum\" label=\"表单控件数量\" rules={[{ validator: this.itemNumValidator }]}>\r\n                            <InputNumber onChange={this.changeItemNum} min={0} />\r\n                        </Form.Item>\r\n                        {/* 根据itemList数组生成控件列表 */}\r\n                        {itemList.map(({ itemName, type, defaultValue }, index) => {\r\n                            let ifThreeColumns = type === \"radio\" || type === \"checkbox\" || type === \"select\";\r\n                            let props = type ? { initialValue: type } : {};\r\n                            return (\r\n                                <Row gutter={10} key={index} className=\"item-line\">\r\n                                    <Col span={24} lg={ifThreeColumns ? 10 : 12}>\r\n                                        <Form.Item name={`itemName${index}`} label={`控件  ${index + 1}：`} key={`${index}Name`} rules={[{ validator: this.itemNameValidator.bind(this, index) }]} initialValue={itemName}>\r\n                                            <Input placeholder={`控件 ${index + 1}的名称`} onChange={this.changeItemName.bind(this, index)} />\r\n                                        </Form.Item>\r\n                                    </Col>\r\n                                    <Col span={24} lg={ifThreeColumns ? 7 : 12}>\r\n                                        <Form.Item className=\"col-nolabel\" name={`itemType${index}`} key={`${index}Type`} rules={[{ validator: this.itemTypeValidator.bind(this, index) }]} {...props}>\r\n                                            <Select onChange={this.changeItemType.bind(this, index)} placeholder=\"--控件类型--\">\r\n                                                {inputType.map((type, index) => {\r\n                                                    return (\r\n                                                        <Option value={type} key={index}>\r\n                                                            {type === \"text\" ? \"输入框\" : (type === \"radio\" ? \"单选框\" : (type === \"checkbox\" ? \"复选框\" : (type === \"select\" ? \"选择器\" : (type === \"textarea\" ? \"文本域\" : (type === \"upload\" ? \"上传文件\" : null)))))}\r\n                                                        </Option>\r\n                                                    );\r\n                                                })}\r\n                                            </Select>\r\n                                        </Form.Item>\r\n                                    </Col>\r\n                                    {ifThreeColumns ?\r\n                                        <Col span={24} lg={7}>\r\n                                            <Form.Item className=\"col-nolabel\" name={`itemValue${index}`} key={`${index}Value`} rules={[{ validator: this.itemValueValidator.bind(this, index) }]} getValueFromEvent={e => e.target.value.replace(/\\uff0c/g, \",\")} initialValue={defaultValue}>\r\n                                                <Input placeholder={`请输入控件的默认值,以“,”隔开`} onChange={this.changeItemValue.bind(this, index)} />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                        : null}\r\n                                    <Col style={{ lineHeight: \"30px\" }} className=\"delete-btn\">\r\n                                        <CloseCircleFilled onClick={this.handleDelete.bind(this, index)} title=\"删除控件\" />\r\n                                    </Col>\r\n                                </Row>\r\n                            )\r\n                        })}\r\n                        <Form.Item style={{ textAlign: \"center\", marginTop: \"24px\" }}>\r\n                            <Space>\r\n                                <Button type=\"primary\" onClick={this.saveItems}>保存表单数据</Button>\r\n                                <Button type=\"primary\" onClick={() => { document.getElementById(\"file\").click() }}>读取表单数据</Button>\r\n                                <input type=\"file\" name=\"import\" id=\"file\" accept=\".json\" onChange={this.importItems} style={{ display: \"none\" }} />\r\n                            </Space>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </div>\r\n                <div className=\"show block\">\r\n                    <div style={{ fontSize: 20, fontWeight: \"600\" }}>预览表单</div>\r\n                    <div style={{ textAlign: \"center\", fontSize: 20 }}>{formName}</div>\r\n                    <br />\r\n                    <Form ref=\"showForm\">\r\n                        {itemList.map(({ itemName, type, defaultValue, currentValue }, index) => {\r\n                            switch (type) {\r\n                                case \"text\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <Input placeholder={itemName} onChange={this.handleChange.bind(this, index, type)} value={currentValue} defaultValue={currentValue} />\r\n                                    </Form.Item>;\r\n                                case \"radio\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <Radio.Group onChange={this.handleChange.bind(this, index, type)} value={currentValue} defaultValue={currentValue}>\r\n                                            {defaultValue.map((value, index2) => {\r\n                                                return (\r\n                                                    <Radio key={index2} value={value}>\r\n                                                        {value}\r\n                                                    </Radio>\r\n                                                );\r\n                                            })}\r\n                                        </Radio.Group>\r\n                                    </Form.Item>;\r\n                                case \"checkbox\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <Checkbox.Group options={defaultValue} onChange={this.handleChange.bind(this, index, type)} value={currentValue} defaultValue={currentValue} />\r\n                                    </Form.Item>;\r\n                                case \"select\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <Select onChange={this.handleChange.bind(this, index, type)} value={currentValue} defaultValue={currentValue}>\r\n                                            {defaultValue.map((value, index2) => {\r\n                                                return (\r\n                                                    <Option key={index2} value={value}>\r\n                                                        {value}\r\n                                                    </Option>\r\n                                                );\r\n                                            })}\r\n                                        </Select>\r\n                                    </Form.Item>;\r\n                                case \"textarea\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <TextArea autoSize={{ minRows: 4, maxRows: 20 }} cols={10} onChange={this.handleChange.bind(this, index, type)} value={currentValue} defaultValue={currentValue} />\r\n                                    </Form.Item>;\r\n                                case \"upload\":\r\n                                    return <Form.Item label={itemName} key={index}>\r\n                                        <Upload {...uploadProps} onChange={this.changeUpload.bind(this, index)} defaultFileList={currentValue}>\r\n                                            <Button type=\"default\"><UploadOutlined />上传文件</Button>\r\n                                        </Upload>\r\n                                    </Form.Item>;\r\n                                default:\r\n                                    return null;\r\n                            }\r\n                        })}\r\n                    </Form>\r\n                </div>\r\n            </div >\r\n        )\r\n    }\r\n}"],"sourceRoot":""}